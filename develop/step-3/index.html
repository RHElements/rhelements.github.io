<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta name="generator" content="Hugo 0.47.1" />
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> Write tests </title>

  
  
  
  
  
  

  

  <meta name="author" content="RHElements">


  <meta property="og:title" content="Write tests" />
<meta property="og:description" content="Let&rsquo;s write a test for the rh-cool-element.
We rely on a few tools to ensure our element is reliable in production: 1. Web Component Tester, built and maintained by the Polymer team, makes testing easy. All we have to do is add the element&rsquo;s HTML to a file and set up our suite of tests. 2. We&rsquo;ll use the Chai Assertion Library to make sure our tests pass since Mocha and Chai are both included in Web Component Tester." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/develop/step-3/" /><meta property="article:published_time" content="2018-08-31T14:02:31-04:00"/>
<meta property="article:modified_time" content="2018-08-31T14:02:31-04:00"/>
  




  
  
  
  

  <link rel="canonical" href="/develop/step-3/">  

  <link rel="shortcut icon" href="./img/favicons/favicon.ico">


  <link href="/css/font.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.min.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.legenda.css" rel="stylesheet" type="text/css">
  <link href="/css/highlight.css" rel="stylesheet" type="text/css">
  <link href="/css/master.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.demo.css" rel="stylesheet" type="text/css">
  
  
  
  <link rel="stylesheet" href="/src/sass/kube.min.8178dadef12d827c64aa3d80bb0ab512476e83a712fabbcab18e68c4761711fe.css">
  
 

  <script src="/js/jquery-2.1.4.min.js" type="text/javascript">
  </script>

  <script type="text/javascript" src="/js/tocbot.min.js"></script>
</head>


<body class="page-kube">
  <header> 
<div class="show-sm" id="top-sm">
  <div id="nav-toggle-box">
    <div id="nav-toggle-brand">
      <section id="top-brand">
        <a href="/" title="home"><span>RH</span>Elements</a>
      </section>
    </div>
    <a data-component="offcanvas" data-target="#mobile-toc" href="#" id="nav-toggle"><i class="kube-menu"></i></a>
  </div>
</div>
<div class="hide-sm" id="top">
  <section id="top-brand">
    <a href="/" title="home"><span>RH</span>Elements</a>
  </section>
  <nav id="top-nav-main">
    
    
    <ul>
      <li><a href="/getting-started">Getting Started</a></li>
      <li><a href="/develop">Develop</a></li>
      <li><a href="/theme">Theme</a></li>
    </ul>
  </nav>
  <nav id="top-nav-extra"> 
    <ul>
       
        <li>
          <a href="/site-info/community">Community</a>
        </li>
       
        <li>
          <a href="/site-info/get-help">Help</a>
        </li>
        
    </ul>
  </nav>
</div>

<section id="mobile-toc" class="hide">
  <ul>
    
     
    
      <li> 
        <a href="/getting-started/">Getting Started</a>
        
      </li>
    
      <li> 
        <a href="/develop/">Develop</a>
        
      </li>
    
      <li> 
        <a href="/theme/">Theme</a>
        
      </li>
    
  </ul>
  
</section>
 </header>
  <main>

<article style="display: flex; flex-direction: row;">
  
  <nav id="main-toc">
    <section class="inner-toc">
      <h3><a href="/getting-started">Getting Started</a></h3>
      <ul>
        
          <li>
            <a href="/getting-started/browser-support" title="Browser Support">
              Browser Support
            </a>
          </li>
        
          <li>
            <a href="/getting-started/framework-support/" title="Framework Support">
              Framework Support
            </a>
          </li>
        
          <li>
            <a href="/getting-started/polyfills/" title="Polyfills">
              Polyfills
            </a>
          </li>
        
      </ul>
      <h3><a href="/develop">Develop</a></h3>
      <ul>
        
          <li>
            <a href="/develop/step-1a/" title="Setup">
              Setup
            </a>
          </li>
        
          <li>
            <a href="/develop/step-1b/" title="Create a RHElement">
              Create a RHElement
            </a>
          </li>
        
          <li>
            <a href="/develop/step-2a/" title="Develop a Structure">
              Develop a Structure
            </a>
          </li>
        
          <li>
            <a href="/develop/step-2b/" title="Write your HTML">
              Write your HTML
            </a>
          </li>
        
          <li>
            <a href="/develop/step-2c/" title="Write your CSS (or Sass)">
              Write your CSS (or Sass)
            </a>
          </li>
        
          <li>
            <a href="/develop/step-2d/" title="Integrate your JavaScript">
              Integrate your JavaScript
            </a>
          </li>
        
          <li>
            <a href="/develop/step-3/" title="Write tests">
              Write tests
            </a>
          </li>
        
          <li>
            <a href="/develop/step-4/" title="Publish">
              Publish
            </a>
          </li>
        
      </ul>
      <h3><a href="/theme">Theme</a></h3>
      <ul>
        
          <li>
            <a href="/theme/rhe-theme-component/" title="Create a themed RHElement">
              Create a themed RHElement
            </a>
          </li>
        
          <li>
            <a href="/theme/rhe-color-palette/" title="RHElements color palette">
              RHElements color palette
            </a>
          </li>
        
          <li>
            <a href="/theme/rhe-layouts/" title="RH Layouts">
              RH Layouts
            </a>
          </li>
        
      </ul>
      
      <h3>Contact</h3>
      <ul>
         
          <li>
            <a href="/site-info/community">Community</a>
          </li>
         
          <li>
            <a href="/site-info/get-help">Help</a>
          </li>
          
      </ul>
    </section>
  </nav>
  
  <section id="content" style="">
    <header class="page-header">
      <h1> Write tests</h1>
      <p></p>
    </header>
    
    <ul id="posts">

     

<p>Let&rsquo;s write a test for the <code>rh-cool-element</code>.</p>

<p>We rely on a few tools to ensure our element is reliable in production:
1. <a href="https://github.com/Polymer/web-component-tester">Web Component Tester</a>, built and maintained by the Polymer team, makes testing easy. All we have to do is add the element&rsquo;s HTML to a file and set up our suite of tests.
2. We&rsquo;ll use the <a href="http://chaijs.com/api/assert/">Chai Assertion Library</a> to make sure our tests pass since Mocha and Chai are both included in Web Component Tester.
3. Finally, we integrate tests with <a href="https://travis-ci.org">Travis CI</a>.</p>

<h2 id="web-component-tester">Web Component Tester</h2>

<p>If you followed the <a href="{{ &quot;/docs/get-started.html#prerequisites&quot; | relative_url }}">Prerequisites</a> in <a href="{{ &quot;/docs/get-started.html&quot; | relative_url }}">Getting Started</a>, your setup should already be done.</p>

<h3 id="test-setup">Test Setup</h3>

<p>In the root of the element, there&rsquo;s a <code>/test</code> directory with an <code>index.html</code> and a <code>rh-cool-element_test.html</code> file. The <code>index.html</code> file tells Web Component Tester which files to test.</p>

<p>For this example, <code>rh-cool-element_test.html</code> is the only file.</p>

<pre><code>&lt;!doctype html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes&quot;&gt;
    &lt;script src=&quot;/components/web-component-tester/browser.js&quot;&gt;&lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;script&gt;
      // Load and run all tests (.html, .js):
      WCT.loadSuites([
        'rh-cool-element_test.html'
      ]);
    &lt;/script&gt;

&lt;/body&gt;&lt;/html&gt;
</code></pre>

<p>We&rsquo;ve included the web component polyfill and <code>wct-browser-legacy/browser.js</code> in the <code>/test/index.html</code> file. We need <code>wct-browser-legacy/browser.js</code> because Web Component Tester looks for web components loaded from a <code>bower_components</code> directory. However, our web components are installed via npm and served from a <code>node_modules</code> directory, meaning that we&rsquo;re required to use <code>wct-browser-legacy</code> (Reference to the <a href="https://github.com/Polymer/web-component-tester#node-support">Node support section of the Web Component Tester README</a>).</p>

<p>The setup for <code>/test/rh-cool-element_test.html</code> is pretty simple.</p>

<p>We&rsquo;ll add four stubs for the functionality we need to test:</p>

<pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes&quot;&gt;
    &lt;script src=&quot;/components/@webcomponents/webcomponentsjs/webcomponents-bundle.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;/components/web-component-tester/browser.js&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;module&quot; src=&quot;../rh-cool-element.js&quot;&gt;&lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;rh-cool-element photo-url=&quot;https://avatars2.githubusercontent.com/u/330256?s=400&amp;u=de56919e816dc9f821469c2f86174f29141a896e&amp;v=4&quot;&gt;
      Kyle Buchanan
    &lt;/rh-cool-element&gt;

    &lt;script&gt;
      suite('&lt;rh-cool-element&gt;', () =&gt; {
        test('it should upgrade', () =&gt; {
          const rhCoolElement = document.querySelector('rh-cool-element');
          assert.instanceOf(rhCoolElement, customElements.get(&quot;rh-cool-element&quot;, 'rh-cool-element should be an instance of rhCoolElement'));
        });

        test('it should set a username from the light DOM', () =&gt; {

        });

        test('it should allow a user to follow a profile', () =&gt; {

        });

        test('it should set the state to follow if the following attribute is present', () =&gt; {

        });

        test('it should set a profile pic from the photo-url attribute', () =&gt; {

        });
      });
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>Note that we using <code>&lt;script type=&quot;module&quot;...</code> to load our element definition to make sure we&rsquo;re testing the true source of our element instead of the transpiled version. You&rsquo;ll also notice the HTML included to set up our tests. This is the same HTML from our <code>/demo/index.html</code> file.</p>

<p>Lastly, there&rsquo;s one additional piece that can help us test thoroughly. In the root of the RHElements repo, locate the <code>wct.conf.json</code> file.</p>

<p>We&rsquo;ll use this to tell Web Component Tester to test in both Chrome and Firefox:</p>

<pre><code>{
  &quot;verbose&quot;: false,
  &quot;npm&quot;: true,
  &quot;plugins&quot;: {
    &quot;local&quot;: {
      &quot;browsers&quot;: [&quot;chrome&quot;],
      &quot;browserOptions&quot;: {
        &quot;chrome&quot;: [&quot;headless&quot;, &quot;disable-gpu&quot;, &quot;no-sandbox&quot;],
        &quot;firefox&quot;: [&quot;-headless&quot;]
      }
    }
  }
}
</code></pre>

<p>Now that our setup is complete, we can start building our tests.</p>

<h3 id="test-cases">Test Cases</h3>

<p>Let&rsquo;s build out the &lsquo;rh-cool-element&rsquo; test suites. We&rsquo;ll use <code>document.querySelector</code> to grab our element and include DOM API methods to interact with what we&rsquo;re testing.</p>

<p>Here is the code:</p>

<pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes&quot;&gt;
    &lt;script src=&quot;/components/@webcomponents/webcomponentsjs/webcomponents-bundle.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;/components/web-component-tester/browser.js&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;module&quot; src=&quot;../rh-cool-element.js&quot;&gt;&lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;rh-cool-element photo-url=&quot;https://avatars2.githubusercontent.com/u/330256?s=400&amp;u=de56919e816dc9f821469c2f86174f29141a896e&amp;v=4&quot;&gt;
      Kyle Buchanan
    &lt;/rh-cool-element&gt;

    &lt;script&gt;
      suite('&lt;rh-cool-element&gt;', () =&gt; {
        test('it should upgrade', () =&gt; {
          const rhCoolElement = document.querySelector('rh-cool-element');
          assert.instanceOf(rhCoolElement, customElements.get(&quot;rh-cool-element&quot;, 'rh-cool-element should be an instance of rhCoolElement'));
        });

        test('it should set a username from the light DOM', () =&gt; {
          const element = document.querySelector('rh-cool-element');
          const elementLightDOMContent = element.textContent.trim();
          const shadowRoot = element.shadowRoot;
          const slotContent = shadowRoot.querySelector('slot').assignedNodes()[0].textContent.trim();

          assert.equal(slotContent, elementLightDOMContent);
        });

        test('it should allow a user to follow a profile', () =&gt; {
          const element = document.querySelector('rh-cool-element');
          element.button.click();

          assert.isTrue(element.hasAttribute('following'));
          assert.equal(element.button.textContent, 'Unfollow');

          element.button.click();

          assert.isNotTrue(element.hasAttribute('following'));
          assert.equal(element.button.textContent, 'Follow');
        });

        test('it should set the state to follow if the following attribute is present', () =&gt; {
          const element = document.querySelector('rh-cool-element');
          element.setAttribute('following', '');

          assert.isTrue(element.hasAttribute('following'));
          assert.equal(element.button.textContent, 'Unfollow');

          element.removeAttribute('following');

          assert.isNotTrue(element.hasAttribute('following'));
          assert.equal(element.button.textContent, 'Follow');
        });

        test('it should set a profile pic from the photo-url attribute', () =&gt; {
          const element = document.querySelector('rh-cool-element');
          const photoUrlAttribute = element.getAttribute('photo-url');
          const shadowRoot = element.shadowRoot;
          const profilePicContainer = shadowRoot.querySelector('#profile-pic');
          const backgroundImage = profilePicContainer.style.backgroundImage.slice(5, -2);

          assert.equal(photoUrlAttribute, backgroundImage);
        });
      });
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>You may notice we&rsquo;re accessing the <code>shadowRoot</code> here, available to our element by extending <code>RHElement</code> in the definition of our element. You can also access content in the <code>&lt;slot&gt;&lt;/slot&gt;</code> of your element by using the <code>assignedNodes()</code> method.</p>

<p>We use a slot for the username in <code>rh-cool-element</code>, making it available to us in the array returned by <code>assignedNodes()</code>.</p>

<pre><code>shadowRoot.querySelector('slot').assignedNodes()[0].textContent.trim();
</code></pre>

<h3 id="run-the-test">Run the Test</h3>

<p>Lastly, we can run the test command below to see how we did.</p>

<pre><code>npm test
</code></pre>

<p>Here is the command line output:</p>

<p><img src="/test-output.png" alt="test output" /></p>

<p>Nice! All four tests are working in Chrome and Firefox.</p>

<h2 id="travis-integration">Travis Integration</h2>

<p>That&rsquo;s it for testing, but you can also set up continuous integration on <a href="https://travis-ci.org">Travis CI</a> to run tests for every push to your repository to keep track of future updates.</p>

<p>Now that we&rsquo;ve created our <code>rh-cool-element</code> and all of our code passes, the final step is to publish and share your component on npm!</p>

<p><a href="../step-4">Move to Step 4: Publish</a></p>

     
    </ul>

  </section>

  <aside class="page-toc">
    <h3>Page Contents</h3>
    

<div class="js-toc">
  
</div>

<script type="text/javascript">
document.addEventListener("DOMContentLoaded",
function(){
tocbot.init({

tocSelector: '.js-toc',

contentSelector: '#posts',

headingSelector: 'h2'
})
}
);
</script>


  </aside>
</article>

</main>
  <footer> 
  

<nav>
  <ul>
    <li><span>RHElements</span></li>
    <li>
      <a href="/get-started">Get Started</a>
    </li>
    <li>
      <a href="/develop">Develop</a>
    </li>
      <li>
      <a href="/theme">Theme</a>
    </li>
    <li>
      <a href="/community">Community</a>
    </li>
  </ul>
</nav>
<small>&copy; Licence MIT.</small> 
</footer>


  <script src="/js/kube.min.js" type="text/javascript">
  </script>
  
</body>

</html>
